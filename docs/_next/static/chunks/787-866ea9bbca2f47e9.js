(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[787],{9008:function(a,b,c){a.exports=c(5443)},9365:function(a,b,c){},2854:function(a,b,c){"use strict";c.d(b,{"_":function(){return f}});var d=c(9477);let e=new WeakMap;class f extends d.aNw{constructor(a){super(a),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(a){return this.decoderPath=a,this}setDecoderConfig(a){return this.decoderConfig=a,this}setWorkerLimit(a){return this.workerLimit=a,this}load(a,b,c,e){let f=new d.hH6(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(a,a=>{let c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(a,c).then(b).catch(e)},c,e)}decodeDracoFile(a,b,c,d){let e={attributeIDs:c||this.defaultAttributeIDs,attributeTypes:d||this.defaultAttributeTypes,useUniqueIDs:!!c};this.decodeGeometry(a,e).then(b)}decodeGeometry(a,b){for(let c in b.attributeTypes){let d=b.attributeTypes[c];void 0!==d.BYTES_PER_ELEMENT&&(b.attributeTypes[c]=d.name)}let f=JSON.stringify(b);if(e.has(a)){let g=e.get(a);if(g.key===f)return g.promise;if(0===a.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let h,i=this.workerNextTaskID++,j=a.byteLength,k=this._getWorker(i,j).then(c=>(h=c,new Promise((c,d)=>{h._callbacks[i]={resolve:c,reject:d},h.postMessage({type:"decode",id:i,taskConfig:b,buffer:a},[a])}))).then(a=>this._createGeometry(a.geometry));return k.catch(()=>!0).then(()=>{h&&i&&this._releaseTask(h,i)}),e.set(a,{key:f,promise:k}),k}_createGeometry(a){let b=new d.u9r;a.index&&b.setIndex(new d.TlE(a.index.array,1));for(let c=0;c<a.attributes.length;c++){let e=a.attributes[c],f=e.name,g=e.array,h=e.itemSize;b.setAttribute(f,new d.TlE(g,h))}return b}_loadLibrary(a,b){let c=new d.hH6(this.manager);return c.setPath(this.decoderPath),c.setResponseType(b),c.setWithCredentials(this.withCredentials),new Promise((b,d)=>{c.load(a,b,void 0,d)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let a="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,b=[];return a?b.push(this._loadLibrary("draco_decoder.js","text")):(b.push(this._loadLibrary("draco_wasm_wrapper.js","text")),b.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(b).then(b=>{let c=b[0];a||(this.decoderConfig.wasmBinary=b[1]);let d=g.toString(),e=["/* draco decoder */",c,"","/* worker */",d.substring(d.indexOf("{")+1,d.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([e]))}),this.decoderPending}_getWorker(a,b){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let c=new Worker(this.workerSourceURL);c._callbacks={},c._taskCosts={},c._taskLoad=0,c.postMessage({type:"init",decoderConfig:this.decoderConfig}),c.onmessage=function(a){let b=a.data;switch(b.type){case"decode":c._callbacks[b.id].resolve(b);break;case"error":c._callbacks[b.id].reject(b);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+b.type+'"')}},this.workerPool.push(c)}else this.workerPool.sort(function(a,b){return a._taskLoad>b._taskLoad?-1:1});let d=this.workerPool[this.workerPool.length-1];return d._taskCosts[a]=b,d._taskLoad+=b,d})}_releaseTask(a,b){a._taskLoad-=a._taskCosts[b],delete a._callbacks[b],delete a._taskCosts[b]}debug(){console.log("Task load: ",this.workerPool.map(a=>a._taskLoad))}dispose(){for(let a=0;a<this.workerPool.length;++a)this.workerPool[a].terminate();return this.workerPool.length=0,this}}function g(){let a,b;function c(a,b,c){let d=c.num_faces(),e=3*d,f=4*e,g=a._malloc(f);b.GetTrianglesUInt32Array(c,f,g);let h=new Uint32Array(a.HEAPF32.buffer,g,e).slice();return a._free(g),{array:h,itemSize:1}}function d(a,b,c,d,f,g){let h=g.num_components(),i=c.num_points(),j=i*h,k=j*f.BYTES_PER_ELEMENT,l=e(a,f),m=a._malloc(k);b.GetAttributeDataArrayForAllPoints(c,g,l,k,m);let n=new f(a.HEAPF32.buffer,m,j).slice();return a._free(m),{name:d,array:n,itemSize:h}}function e(a,b){switch(b){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}onmessage=function(e){let f=e.data;switch(f.type){case"init":a=f.decoderConfig,b=new Promise(function(b){a.onModuleLoaded=function(a){b({draco:a})},DracoDecoderModule(a)});break;case"decode":let g=f.buffer,h=f.taskConfig;b.then(a=>{let b=a.draco,e=new b.Decoder,i=new b.DecoderBuffer;i.Init(new Int8Array(g),g.byteLength);try{let j=function a(b,e,f,g){let h=g.attributeIDs,i=g.attributeTypes,j,k,l=e.GetEncodedGeometryType(f);if(l===b.TRIANGULAR_MESH)j=new b.Mesh,k=e.DecodeBufferToMesh(f,j);else if(l===b.POINT_CLOUD)j=new b.PointCloud,k=e.DecodeBufferToPointCloud(f,j);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!k.ok()||0===j.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+k.error_msg());let m={index:null,attributes:[]};for(let n in h){let o=self[i[n]],p,q;if(g.useUniqueIDs)q=h[n],p=e.GetAttributeByUniqueId(j,q);else{if(-1===(q=e.GetAttributeId(j,b[h[n]])))continue;p=e.GetAttribute(j,q)}m.attributes.push(d(b,e,j,n,o,p))}return l===b.TRIANGULAR_MESH&&(m.index=c(b,e,j)),b.destroy(j),m}(b,e,i,h),k=j.attributes.map(a=>a.array.buffer);j.index&&k.push(j.index.array.buffer),self.postMessage({type:"decode",id:f.id,geometry:j},k)}catch(l){console.error(l),self.postMessage({type:"error",id:f.id,error:l.message})}finally{b.destroy(i),b.destroy(e)}})}}}},1217:function(a,b,c){"use strict";c.d(b,{E:function(){return e}});var d=c(9477);class e extends d.aNw{constructor(a){super(a),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(a){return new j(a)}),this.register(function(a){return new q(a)}),this.register(function(a){return new r(a)}),this.register(function(a){return new l(a)}),this.register(function(a){return new m(a)}),this.register(function(a){return new n(a)}),this.register(function(a){return new o(a)}),this.register(function(a){return new i(a)}),this.register(function(a){return new p(a)}),this.register(function(a){return new k(a)}),this.register(function(a){return new g(a)}),this.register(function(a){return new s(a)})}load(a,b,c,e){let f=this,g;g=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:d.Zp0.extractUrlBase(a),this.manager.itemStart(a);let h=function(b){e?e(b):console.error(b),f.manager.itemError(a),f.manager.itemEnd(a)},i=new d.hH6(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(a,function(c){try{f.parse(c,g,function(c){b(c),f.manager.itemEnd(a)},h)}catch(d){h(d)}},c,h)}setDRACOLoader(a){return this.dracoLoader=a,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(a){return this.ktx2Loader=a,this}setMeshoptDecoder(a){return this.meshoptDecoder=a,this}register(a){return -1===this.pluginCallbacks.indexOf(a)&&this.pluginCallbacks.push(a),this}unregister(a){return -1!==this.pluginCallbacks.indexOf(a)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(a),1),this}parse(a,b,c,e){let g,i={},j={};if("string"==typeof a)g=a;else{let k=d.Zp0.decodeText(new Uint8Array(a,0,4));if(k===t){try{i[f.KHR_BINARY_GLTF]=new w(a)}catch(l){e&&e(l);return}g=i[f.KHR_BINARY_GLTF].content}else g=d.Zp0.decodeText(new Uint8Array(a))}let m=JSON.parse(g);if(void 0===m.asset||m.asset.version[0]<2){e&&e(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let n=new V(m,{path:b||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});n.fileLoader.setRequestHeader(this.requestHeader);for(let o=0;o<this.pluginCallbacks.length;o++){let p=this.pluginCallbacks[o](n);j[p.name]=p,i[p.name]=!0}if(m.extensionsUsed)for(let q=0;q<m.extensionsUsed.length;++q){let r=m.extensionsUsed[q],s=m.extensionsRequired||[];switch(r){case f.KHR_MATERIALS_UNLIT:i[r]=new h;break;case f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:i[r]=new A;break;case f.KHR_DRACO_MESH_COMPRESSION:i[r]=new x(m,this.dracoLoader);break;case f.KHR_TEXTURE_TRANSFORM:i[r]=new y;break;case f.KHR_MESH_QUANTIZATION:i[r]=new B;break;default:s.indexOf(r)>=0&& void 0===j[r]&&console.warn('THREE.GLTFLoader: Unknown extension "'+r+'".')}}n.setExtensions(i),n.setPlugins(j),n.parse(c,e)}parseAsync(a,b){let c=this;return new Promise(function(d,e){c.parse(a,b,d,e)})}}let f={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class g{constructor(a){this.parser=a,this.name=f.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let a=this.parser,b=this.parser.json.nodes||[];for(let c=0,d=b.length;c<d;c++){let e=b[c];e.extensions&&e.extensions[this.name]&& void 0!==e.extensions[this.name].light&&a._addNodeRef(this.cache,e.extensions[this.name].light)}}_loadLight(a){let b=this.parser,c="light:"+a,e=b.cache.get(c);if(e)return e;let f=b.json,g=f.extensions&&f.extensions[this.name]||{},h=g.lights||[],i=h[a],j,k=new d.Ilk(16777215);void 0!==i.color&&k.fromArray(i.color);let l=void 0!==i.range?i.range:0;switch(i.type){case"directional":(j=new d.Ox3(k)).target.position.set(0,0,-1),j.add(j.target);break;case"point":(j=new d.cek(k)).distance=l;break;case"spot":(j=new d.PMe(k)).distance=l,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,j.angle=i.spot.outerConeAngle,j.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,j.target.position.set(0,0,-1),j.add(j.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return j.position.set(0,0,0),j.decay=2,void 0!==i.intensity&&(j.intensity=i.intensity),j.name=b.createUniqueName(i.name||"light_"+a),e=Promise.resolve(j),b.cache.add(c,e),e}createNodeAttachment(a){let b=this,c=this.parser,d=c.json,e=d.nodes[a],f=e.extensions&&e.extensions[this.name]||{},g=f.light;return void 0===g?null:this._loadLight(g).then(function(a){return c._getNodeRef(b.cache,g,a)})}}class h{constructor(){this.name=f.KHR_MATERIALS_UNLIT}getMaterialType(){return d.vBJ}extendParams(a,b,c){let e=[];a.color=new d.Ilk(1,1,1),a.opacity=1;let f=b.pbrMetallicRoughness;if(f){if(Array.isArray(f.baseColorFactor)){let g=f.baseColorFactor;a.color.fromArray(g),a.opacity=g[3]}void 0!==f.baseColorTexture&&e.push(c.assignTexture(a,"map",f.baseColorTexture,d.knz))}return Promise.all(e)}}class i{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(a,b){let c=this.parser,d=c.json.materials[a];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();let e=d.extensions[this.name].emissiveStrength;return void 0!==e&&(b.emissiveIntensity=e),Promise.resolve()}}class j{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_CLEARCOAT}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,e=c.json.materials[a];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();let f=[],g=e.extensions[this.name];if(void 0!==g.clearcoatFactor&&(b.clearcoat=g.clearcoatFactor),void 0!==g.clearcoatTexture&&f.push(c.assignTexture(b,"clearcoatMap",g.clearcoatTexture)),void 0!==g.clearcoatRoughnessFactor&&(b.clearcoatRoughness=g.clearcoatRoughnessFactor),void 0!==g.clearcoatRoughnessTexture&&f.push(c.assignTexture(b,"clearcoatRoughnessMap",g.clearcoatRoughnessTexture)),void 0!==g.clearcoatNormalTexture&&(f.push(c.assignTexture(b,"clearcoatNormalMap",g.clearcoatNormalTexture)),void 0!==g.clearcoatNormalTexture.scale)){let h=g.clearcoatNormalTexture.scale;b.clearcoatNormalScale=new d.FM8(h,h)}return Promise.all(f)}}class k{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_IRIDESCENCE}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,d=c.json.materials[a];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();let e=[],f=d.extensions[this.name];return void 0!==f.iridescenceFactor&&(b.iridescence=f.iridescenceFactor),void 0!==f.iridescenceTexture&&e.push(c.assignTexture(b,"iridescenceMap",f.iridescenceTexture)),void 0!==f.iridescenceIor&&(b.iridescenceIOR=f.iridescenceIor),void 0===b.iridescenceThicknessRange&&(b.iridescenceThicknessRange=[100,400]),void 0!==f.iridescenceThicknessMinimum&&(b.iridescenceThicknessRange[0]=f.iridescenceThicknessMinimum),void 0!==f.iridescenceThicknessMaximum&&(b.iridescenceThicknessRange[1]=f.iridescenceThicknessMaximum),void 0!==f.iridescenceThicknessTexture&&e.push(c.assignTexture(b,"iridescenceThicknessMap",f.iridescenceThicknessTexture)),Promise.all(e)}}class l{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_SHEEN}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,e=c.json.materials[a];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();let f=[];b.sheenColor=new d.Ilk(0,0,0),b.sheenRoughness=0,b.sheen=1;let g=e.extensions[this.name];return void 0!==g.sheenColorFactor&&b.sheenColor.fromArray(g.sheenColorFactor),void 0!==g.sheenRoughnessFactor&&(b.sheenRoughness=g.sheenRoughnessFactor),void 0!==g.sheenColorTexture&&f.push(c.assignTexture(b,"sheenColorMap",g.sheenColorTexture,d.knz)),void 0!==g.sheenRoughnessTexture&&f.push(c.assignTexture(b,"sheenRoughnessMap",g.sheenRoughnessTexture)),Promise.all(f)}}class m{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_TRANSMISSION}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,d=c.json.materials[a];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();let e=[],f=d.extensions[this.name];return void 0!==f.transmissionFactor&&(b.transmission=f.transmissionFactor),void 0!==f.transmissionTexture&&e.push(c.assignTexture(b,"transmissionMap",f.transmissionTexture)),Promise.all(e)}}class n{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_VOLUME}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,e=c.json.materials[a];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();let f=[],g=e.extensions[this.name];b.thickness=void 0!==g.thicknessFactor?g.thicknessFactor:0,void 0!==g.thicknessTexture&&f.push(c.assignTexture(b,"thicknessMap",g.thicknessTexture)),b.attenuationDistance=g.attenuationDistance||0;let h=g.attenuationColor||[1,1,1];return b.attenuationColor=new d.Ilk(h[0],h[1],h[2]),Promise.all(f)}}class o{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_IOR}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,d=c.json.materials[a];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();let e=d.extensions[this.name];return b.ior=void 0!==e.ior?e.ior:1.5,Promise.resolve()}}class p{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_SPECULAR}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,e=c.json.materials[a];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();let f=[],g=e.extensions[this.name];b.specularIntensity=void 0!==g.specularFactor?g.specularFactor:1,void 0!==g.specularTexture&&f.push(c.assignTexture(b,"specularIntensityMap",g.specularTexture));let h=g.specularColorFactor||[1,1,1];return b.specularColor=new d.Ilk(h[0],h[1],h[2]),void 0!==g.specularColorTexture&&f.push(c.assignTexture(b,"specularColorMap",g.specularColorTexture,d.knz)),Promise.all(f)}}class q{constructor(a){this.parser=a,this.name=f.KHR_TEXTURE_BASISU}loadTexture(a){let b=this.parser,c=b.json,d=c.textures[a];if(!d.extensions||!d.extensions[this.name])return null;let e=d.extensions[this.name],f=b.options.ktx2Loader;if(!f){if(!(c.extensionsRequired&&c.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return b.loadTextureImage(a,e.source,f)}}class r{constructor(a){this.parser=a,this.name=f.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(a){let b=this.name,c=this.parser,d=c.json,e=d.textures[a];if(!e.extensions||!e.extensions[b])return null;let f=e.extensions[b],g=d.images[f.source],h=c.textureLoader;if(g.uri){let i=c.options.manager.getHandler(g.uri);null!==i&&(h=i)}return this.detectSupport().then(function(e){if(e)return c.loadTextureImage(a,f.source,h);if(d.extensionsRequired&&d.extensionsRequired.indexOf(b)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return c.loadTexture(a)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(a){let b=new Image;b.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",b.onload=b.onerror=function(){a(1===b.height)}})),this.isSupported}}class s{constructor(a){this.name=f.EXT_MESHOPT_COMPRESSION,this.parser=a}loadBufferView(a){let b=this.parser.json,c=b.bufferViews[a];if(!c.extensions||!c.extensions[this.name])return null;{let d=c.extensions[this.name],e=this.parser.getDependency("buffer",d.buffer),f=this.parser.options.meshoptDecoder;if(!f||!f.supported){if(!(b.extensionsRequired&&b.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return Promise.all([e,f.ready]).then(function(a){let b=d.byteOffset||0,c=d.byteLength||0,e=d.count,g=d.byteStride,h=new ArrayBuffer(e*g),i=new Uint8Array(a[0],b,c);return f.decodeGltfBuffer(new Uint8Array(h),e,g,i,d.mode,d.filter),h})}}}let t="glTF",u=12,v={JSON:1313821514,BIN:5130562};class w{constructor(a){this.name=f.KHR_BINARY_GLTF,this.content=null,this.body=null;let b=new DataView(a,0,u);if(this.header={magic:d.Zp0.decodeText(new Uint8Array(a.slice(0,4))),version:b.getUint32(4,!0),length:b.getUint32(8,!0)},this.header.magic!==t)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let c=this.header.length-u,e=new DataView(a,u),g=0;for(;g<c;){let h=e.getUint32(g,!0);g+=4;let i=e.getUint32(g,!0);if(g+=4,i===v.JSON){let j=new Uint8Array(a,u+g,h);this.content=d.Zp0.decodeText(j)}else if(i===v.BIN){let k=u+g;this.body=a.slice(k,k+h)}g+=h}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class x{constructor(a,b){if(!b)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=f.KHR_DRACO_MESH_COMPRESSION,this.json=a,this.dracoLoader=b,this.dracoLoader.preload()}decodePrimitive(a,b){let c=this.json,d=this.dracoLoader,e=a.extensions[this.name].bufferView,f=a.extensions[this.name].attributes,g={},h={},i={};for(let j in f){let k=K[j]||j.toLowerCase();g[k]=f[j]}for(let l in a.attributes){let m=K[l]||l.toLowerCase();if(void 0!==f[l]){let n=c.accessors[a.attributes[l]],o=G[n.componentType];i[m]=o,h[m]=!0===n.normalized}}return b.getDependency("bufferView",e).then(function(a){return new Promise(function(b){d.decodeDracoFile(a,function(a){for(let c in a.attributes){let d=a.attributes[c],e=h[c];void 0!==e&&(d.normalized=e)}b(a)},g,i)})})}}class y{constructor(){this.name=f.KHR_TEXTURE_TRANSFORM}extendTexture(a,b){return void 0!==b.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===b.offset&& void 0===b.rotation&& void 0===b.scale||(a=a.clone(),void 0!==b.offset&&a.offset.fromArray(b.offset),void 0!==b.rotation&&(a.rotation=b.rotation),void 0!==b.scale&&a.repeat.fromArray(b.scale),a.needsUpdate=!0),a}}class z extends d.Wid{constructor(a){super(),this.isGLTFSpecularGlossinessMaterial=!0;let b={specular:{value:new d.Ilk().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=b,this.onBeforeCompile=function(a){for(let c in b)a.uniforms[c]=b[c];a.fragmentShader=a.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>","#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif").replace("#include <metalnessmap_pars_fragment>","#ifdef USE_GLOSSINESSMAP\n	uniform sampler2D glossinessMap;\n#endif").replace("#include <roughnessmap_fragment>","vec3 specularFactor = specular;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n	specularFactor *= texelSpecular.rgb;\n#endif").replace("#include <metalnessmap_fragment>","float glossinessFactor = glossiness;\n#ifdef USE_GLOSSINESSMAP\n	vec4 texelGlossiness = texture2D( glossinessMap, vUv );\n	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n	glossinessFactor *= texelGlossiness.a;\n#endif").replace("#include <lights_physical_fragment>","PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\nmaterial.specularColor = specularFactor;")},Object.defineProperties(this,{specular:{get:function(){return b.specular.value},set:function(a){b.specular.value=a}},specularMap:{get:function(){return b.specularMap.value},set:function(a){b.specularMap.value=a,a?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return b.glossiness.value},set:function(a){b.glossiness.value=a}},glossinessMap:{get:function(){return b.glossinessMap.value},set:function(a){b.glossinessMap.value=a,a?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(a)}copy(a){return super.copy(a),this.specularMap=a.specularMap,this.specular.copy(a.specular),this.glossinessMap=a.glossinessMap,this.glossiness=a.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class A{constructor(){this.name=f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return z}extendParams(a,b,c){let e=b.extensions[this.name];a.color=new d.Ilk(1,1,1),a.opacity=1;let f=[];if(Array.isArray(e.diffuseFactor)){let g=e.diffuseFactor;a.color.fromArray(g),a.opacity=g[3]}if(void 0!==e.diffuseTexture&&f.push(c.assignTexture(a,"map",e.diffuseTexture,d.knz)),a.emissive=new d.Ilk(0,0,0),a.glossiness=void 0!==e.glossinessFactor?e.glossinessFactor:1,a.specular=new d.Ilk(1,1,1),Array.isArray(e.specularFactor)&&a.specular.fromArray(e.specularFactor),void 0!==e.specularGlossinessTexture){let h=e.specularGlossinessTexture;f.push(c.assignTexture(a,"glossinessMap",h)),f.push(c.assignTexture(a,"specularMap",h,d.knz))}return Promise.all(f)}createMaterial(a){let b=new z(a);return b.fog=!0,b.color=a.color,b.map=void 0===a.map?null:a.map,b.lightMap=null,b.lightMapIntensity=1,b.aoMap=void 0===a.aoMap?null:a.aoMap,b.aoMapIntensity=1,b.emissive=a.emissive,b.emissiveIntensity=void 0===a.emissiveIntensity?1:a.emissiveIntensity,b.emissiveMap=void 0===a.emissiveMap?null:a.emissiveMap,b.bumpMap=void 0===a.bumpMap?null:a.bumpMap,b.bumpScale=1,b.normalMap=void 0===a.normalMap?null:a.normalMap,b.normalMapType=d.IOt,a.normalScale&&(b.normalScale=a.normalScale),b.displacementMap=null,b.displacementScale=1,b.displacementBias=0,b.specularMap=void 0===a.specularMap?null:a.specularMap,b.specular=a.specular,b.glossinessMap=void 0===a.glossinessMap?null:a.glossinessMap,b.glossiness=a.glossiness,b.alphaMap=null,b.envMap=void 0===a.envMap?null:a.envMap,b.envMapIntensity=1,b}}class B{constructor(){this.name=f.KHR_MESH_QUANTIZATION}}class C extends d._C8{constructor(a,b,c,d){super(a,b,c,d)}copySampleValue_(a){let b=this.resultBuffer,c=this.sampleValues,d=this.valueSize,e=a*d*3+d;for(let f=0;f!==d;f++)b[f]=c[e+f];return b}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=2*g,i=3*g,j=d-b,k=(c-b)/j,l=k*k,m=l*k,n=a*i,o=n-i,p=-2*m+3*l,q=m-l,r=1-p,s=q-l+k;for(let t=0;t!==g;t++){let u=f[o+t+g],v=f[o+t+h]*j,w=f[n+t+g],x=f[n+t]*j;e[t]=r*u+s*v+p*w+q*x}return e}}let D=new d._fP;class E extends C{interpolate_(a,b,c,d){let e=super.interpolate_(a,b,c,d);return D.fromArray(e).normalize().toArray(e),e}}let F={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},G={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},H={9728:d.TyD,9729:d.wem,9984:d.YLQ,9985:d.qyh,9986:d.aH4,9987:d.D1R},I={33071:d.uWy,33648:d.OoA,10497:d.rpg},J={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},K={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},L={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},M={CUBICSPLINE:void 0,LINEAR:d.NMF,STEP:d.Syv},N={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function O(a){return void 0===a.DefaultMaterial&&(a.DefaultMaterial=new d.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.Wl3})),a.DefaultMaterial}function P(a,b,c){for(let d in c.extensions)void 0===a[d]&&(b.userData.gltfExtensions=b.userData.gltfExtensions||{},b.userData.gltfExtensions[d]=c.extensions[d])}function Q(a,b){void 0!==b.extras&&("object"==typeof b.extras?Object.assign(a.userData,b.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+b.extras))}function R(a,b){if(a.updateMorphTargets(),void 0!==b.weights)for(let c=0,d=b.weights.length;c<d;c++)a.morphTargetInfluences[c]=b.weights[c];if(b.extras&&Array.isArray(b.extras.targetNames)){let e=b.extras.targetNames;if(a.morphTargetInfluences.length===e.length){a.morphTargetDictionary={};for(let f=0,g=e.length;f<g;f++)a.morphTargetDictionary[e[f]]=f}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function S(a){let b=a.extensions&&a.extensions[f.KHR_DRACO_MESH_COMPRESSION],c;return b?"draco:"+b.bufferView+":"+b.indices+":"+T(b.attributes):a.indices+":"+T(a.attributes)+":"+a.mode}function T(a){let b="",c=Object.keys(a).sort();for(let d=0,e=c.length;d<e;d++)b+=c[d]+":"+a[c[d]]+";";return b}function U(a){switch(a){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class V{constructor(a={},b={}){this.json=a,this.extensions={},this.plugins={},this.options=b,this.cache=new function(){let a={};return{get:function(b){return a[b]},add:function(b,c){a[b]=c},remove:function(b){delete a[b]},removeAll:function(){a={}}}},this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let c=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),e=navigator.userAgent.indexOf("Firefox")> -1,f=e?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;"undefined"==typeof createImageBitmap||c||e&&f<98?this.textureLoader=new d.dpR(this.options.manager):this.textureLoader=new d.QRU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(a){this.extensions=a}setPlugins(a){this.plugins=a}parse(a,b){let c=this,d=this.json,e=this.extensions;this.cache.removeAll(),this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([c.getDependencies("scene"),c.getDependencies("animation"),c.getDependencies("camera"),])}).then(function(b){let f={scene:b[0][d.scene||0],scenes:b[0],animations:b[1],cameras:b[2],asset:d.asset,parser:c,userData:{}};P(e,f,d),Q(f,d),Promise.all(c._invokeAll(function(a){return a.afterRoot&&a.afterRoot(f)})).then(function(){a(f)})}).catch(b)}_markDefs(){let a=this.json.nodes||[],b=this.json.skins||[],c=this.json.meshes||[];for(let d=0,e=b.length;d<e;d++){let f=b[d].joints;for(let g=0,h=f.length;g<h;g++)a[f[g]].isBone=!0}for(let i=0,j=a.length;i<j;i++){let k=a[i];void 0!==k.mesh&&(this._addNodeRef(this.meshCache,k.mesh),void 0!==k.skin&&(c[k.mesh].isSkinnedMesh=!0)),void 0!==k.camera&&this._addNodeRef(this.cameraCache,k.camera)}}_addNodeRef(a,b){void 0!==b&&(void 0===a.refs[b]&&(a.refs[b]=a.uses[b]=0),a.refs[b]++)}_getNodeRef(a,b,c){if(a.refs[b]<=1)return c;let d=c.clone(),e=(a,b)=>{let c=this.associations.get(a);for(let[d,f]of(null!=c&&this.associations.set(b,c),a.children.entries()))e(f,b.children[d])};return e(c,d),d.name+="_instance_"+a.uses[b]++,d}_invokeOne(a){let b=Object.values(this.plugins);b.push(this);for(let c=0;c<b.length;c++){let d=a(b[c]);if(d)return d}return null}_invokeAll(a){let b=Object.values(this.plugins);b.unshift(this);let c=[];for(let d=0;d<b.length;d++){let e=a(b[d]);e&&c.push(e)}return c}getDependency(a,b){let c=a+":"+b,d=this.cache.get(c);if(!d){switch(a){case"scene":d=this.loadScene(b);break;case"node":d=this.loadNode(b);break;case"mesh":d=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(b)});break;case"accessor":d=this.loadAccessor(b);break;case"bufferView":d=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(b)});break;case"buffer":d=this.loadBuffer(b);break;case"material":d=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(b)});break;case"texture":d=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(b)});break;case"skin":d=this.loadSkin(b);break;case"animation":d=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(b)});break;case"camera":d=this.loadCamera(b);break;default:throw Error("Unknown type: "+a)}this.cache.add(c,d)}return d}getDependencies(a){let b=this.cache.get(a);if(!b){let c=this,d=this.json[a+("mesh"===a?"es":"s")]||[];b=Promise.all(d.map(function(b,d){return c.getDependency(a,d)})),this.cache.add(a,b)}return b}loadBuffer(a){let b=this.json.buffers[a],c=this.fileLoader;if(b.type&&"arraybuffer"!==b.type)throw Error("THREE.GLTFLoader: "+b.type+" buffer type is not supported.");if(void 0===b.uri&&0===a)return Promise.resolve(this.extensions[f.KHR_BINARY_GLTF].body);let e=this.options;return new Promise(function(a,f){c.load(d.Zp0.resolveURL(b.uri,e.path),a,void 0,function(){f(Error('THREE.GLTFLoader: Failed to load buffer "'+b.uri+'".'))})})}loadBufferView(a){let b=this.json.bufferViews[a];return this.getDependency("buffer",b.buffer).then(function(a){let c=b.byteLength||0,d=b.byteOffset||0;return a.slice(d,d+c)})}loadAccessor(a){let b=this,c=this.json,e=this.json.accessors[a];if(void 0===e.bufferView&& void 0===e.sparse)return Promise.resolve(null);let f=[];return void 0!==e.bufferView?f.push(this.getDependency("bufferView",e.bufferView)):f.push(null),void 0!==e.sparse&&(f.push(this.getDependency("bufferView",e.sparse.indices.bufferView)),f.push(this.getDependency("bufferView",e.sparse.values.bufferView))),Promise.all(f).then(function(a){let f=a[0],g=J[e.type],h=G[e.componentType],i=h.BYTES_PER_ELEMENT,j=e.byteOffset||0,k=void 0!==e.bufferView?c.bufferViews[e.bufferView].byteStride:void 0,l=!0===e.normalized,m,n;if(k&&k!==i*g){let o=Math.floor(j/k),p="InterleavedBuffer:"+e.bufferView+":"+e.componentType+":"+o+":"+e.count,q=b.cache.get(p);q||(m=new h(f,o*k,e.count*k/i),q=new d.vpT(m,k/i),b.cache.add(p,q)),n=new d.kB5(q,g,j%k/i,l)}else m=null===f?new h(e.count*g):new h(f,j,e.count*g),n=new d.TlE(m,g,l);if(void 0!==e.sparse){let r=J.SCALAR,s=G[e.sparse.indices.componentType],t=e.sparse.indices.byteOffset||0,u=e.sparse.values.byteOffset||0,v=new s(a[1],t,e.sparse.count*r),w=new h(a[2],u,e.sparse.count*g);null!==f&&(n=new d.TlE(n.array.slice(),n.itemSize,n.normalized));for(let x=0,y=v.length;x<y;x++){let z=v[x];if(n.setX(z,w[x*g]),g>=2&&n.setY(z,w[x*g+1]),g>=3&&n.setZ(z,w[x*g+2]),g>=4&&n.setW(z,w[x*g+3]),g>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return n})}loadTexture(a){let b=this.json,c=this.options,d=b.textures[a],e=d.source,f=b.images[e],g=this.textureLoader;if(f.uri){let h=c.manager.getHandler(f.uri);null!==h&&(g=h)}return this.loadTextureImage(a,e,g)}loadTextureImage(a,b,c){let e=this,f=this.json,g=f.textures[a],h=f.images[b],i=(h.uri||h.bufferView)+":"+g.sampler;if(this.textureCache[i])return this.textureCache[i];let j=this.loadImageSource(b,c).then(function(b){b.flipY=!1,g.name&&(b.name=g.name);let c=f.samplers||{},h=c[g.sampler]||{};return b.magFilter=H[h.magFilter]||d.wem,b.minFilter=H[h.minFilter]||d.D1R,b.wrapS=I[h.wrapS]||d.rpg,b.wrapT=I[h.wrapT]||d.rpg,e.associations.set(b,{textures:a}),b}).catch(function(){return null});return this.textureCache[i]=j,j}loadImageSource(a,b){let c=this.json,e=this.options;if(void 0!==this.sourceCache[a])return this.sourceCache[a].then(a=>a.clone());let f=c.images[a],g=self.URL||self.webkitURL,h=f.uri||"",i=!1;if(void 0!==f.bufferView)h=this.getDependency("bufferView",f.bufferView).then(function(a){i=!0;let b=new Blob([a],{type:f.mimeType});return h=g.createObjectURL(b)});else if(void 0===f.uri)throw Error("THREE.GLTFLoader: Image "+a+" is missing URI and bufferView");let j=Promise.resolve(h).then(function(a){return new Promise(function(c,f){let g=c;!0===b.isImageBitmapLoader&&(g=function(a){let b=new d.xEZ(a);b.needsUpdate=!0,c(b)}),b.load(d.Zp0.resolveURL(a,e.path),g,void 0,f)})}).then(function(a){var b;return!0===i&&g.revokeObjectURL(h),a.userData.mimeType=f.mimeType||((b=f.uri).search(/\.jpe?g($|\?)/i)>0||0===b.search(/^data\:image\/jpeg/)?"image/jpeg":b.search(/\.webp($|\?)/i)>0||0===b.search(/^data\:image\/webp/)?"image/webp":"image/png"),a}).catch(function(a){throw console.error("THREE.GLTFLoader: Couldn't load texture",h),a});return this.sourceCache[a]=j,j}assignTexture(a,b,c,d){let e=this;return this.getDependency("texture",c.index).then(function(g){if(void 0===c.texCoord||0==c.texCoord||"aoMap"===b&&1==c.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+c.texCoord+" for texture "+b+" not yet supported."),e.extensions[f.KHR_TEXTURE_TRANSFORM]){let h=void 0!==c.extensions?c.extensions[f.KHR_TEXTURE_TRANSFORM]:void 0;if(h){let i=e.associations.get(g);g=e.extensions[f.KHR_TEXTURE_TRANSFORM].extendTexture(g,h),e.associations.set(g,i)}}return void 0!==d&&(g.encoding=d),a[b]=g,g})}assignFinalMaterial(a){let b=a.geometry,c=a.material,e=void 0===b.attributes.tangent,f=void 0!==b.attributes.color,g=void 0===b.attributes.normal;if(a.isPoints){let h="PointsMaterial:"+c.uuid,i=this.cache.get(h);i||(i=new d.UY4,d.F5T.prototype.copy.call(i,c),i.color.copy(c.color),i.map=c.map,i.sizeAttenuation=!1,this.cache.add(h,i)),c=i}else if(a.isLine){let j="LineBasicMaterial:"+c.uuid,k=this.cache.get(j);k||(k=new d.nls,d.F5T.prototype.copy.call(k,c),k.color.copy(c.color),this.cache.add(j,k)),c=k}if(e||f||g){let l="ClonedMaterial:"+c.uuid+":";c.isGLTFSpecularGlossinessMaterial&&(l+="specular-glossiness:"),e&&(l+="derivative-tangents:"),f&&(l+="vertex-colors:"),g&&(l+="flat-shading:");let m=this.cache.get(l);m||(m=c.clone(),f&&(m.vertexColors=!0),g&&(m.flatShading=!0),e&&(m.normalScale&&(m.normalScale.y*=-1),m.clearcoatNormalScale&&(m.clearcoatNormalScale.y*=-1)),this.cache.add(l,m),this.associations.set(m,this.associations.get(c))),c=m}c.aoMap&& void 0===b.attributes.uv2&& void 0!==b.attributes.uv&&b.setAttribute("uv2",b.attributes.uv),a.material=c}getMaterialType(){return d.Wid}loadMaterial(a){let b=this,c=this.json,e=this.extensions,g=c.materials[a],h,i={},j=g.extensions||{},k=[];if(j[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){let l=e[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];h=l.getMaterialType(),k.push(l.extendParams(i,g,b))}else if(j[f.KHR_MATERIALS_UNLIT]){let m=e[f.KHR_MATERIALS_UNLIT];h=m.getMaterialType(),k.push(m.extendParams(i,g,b))}else{let n=g.pbrMetallicRoughness||{};if(i.color=new d.Ilk(1,1,1),i.opacity=1,Array.isArray(n.baseColorFactor)){let o=n.baseColorFactor;i.color.fromArray(o),i.opacity=o[3]}void 0!==n.baseColorTexture&&k.push(b.assignTexture(i,"map",n.baseColorTexture,d.knz)),i.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,i.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(k.push(b.assignTexture(i,"metalnessMap",n.metallicRoughnessTexture)),k.push(b.assignTexture(i,"roughnessMap",n.metallicRoughnessTexture))),h=this._invokeOne(function(b){return b.getMaterialType&&b.getMaterialType(a)}),k.push(Promise.all(this._invokeAll(function(b){return b.extendMaterialParams&&b.extendMaterialParams(a,i)})))}!0===g.doubleSided&&(i.side=d.ehD);let p=g.alphaMode||N.OPAQUE;if(p===N.BLEND?(i.transparent=!0,i.depthWrite=!1):(i.transparent=!1,p===N.MASK&&(i.alphaTest=void 0!==g.alphaCutoff?g.alphaCutoff:.5)),void 0!==g.normalTexture&&h!==d.vBJ&&(k.push(b.assignTexture(i,"normalMap",g.normalTexture)),i.normalScale=new d.FM8(1,1),void 0!==g.normalTexture.scale)){let q=g.normalTexture.scale;i.normalScale.set(q,q)}return void 0!==g.occlusionTexture&&h!==d.vBJ&&(k.push(b.assignTexture(i,"aoMap",g.occlusionTexture)),void 0!==g.occlusionTexture.strength&&(i.aoMapIntensity=g.occlusionTexture.strength)),void 0!==g.emissiveFactor&&h!==d.vBJ&&(i.emissive=new d.Ilk().fromArray(g.emissiveFactor)),void 0!==g.emissiveTexture&&h!==d.vBJ&&k.push(b.assignTexture(i,"emissiveMap",g.emissiveTexture,d.knz)),Promise.all(k).then(function(){let c;return c=h===z?e[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(i):new h(i),g.name&&(c.name=g.name),Q(c,g),b.associations.set(c,{materials:a}),g.extensions&&P(e,c,g),c})}createUniqueName(a){let b=d.iUV.sanitizeNodeName(a||""),c=b;for(let e=1;this.nodeNamesUsed[c];++e)c=b+"_"+e;return this.nodeNamesUsed[c]=!0,c}loadGeometries(a){let b=this,c=this.extensions,e=this.primitiveCache;function g(a){return c[f.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,b).then(function(c){return X(c,a,b)})}let h=[];for(let i=0,j=a.length;i<j;i++){let k=a[i],l=S(k),m=e[l];if(m)h.push(m.promise);else{let n;n=k.extensions&&k.extensions[f.KHR_DRACO_MESH_COMPRESSION]?g(k):X(new d.u9r,k,b),e[l]={primitive:k,promise:n},h.push(n)}}return Promise.all(h)}loadMesh(a){let b=this,c=this.json,e=this.extensions,f=c.meshes[a],g=f.primitives,h=[];for(let i=0,j=g.length;i<j;i++){let k=void 0===g[i].material?O(this.cache):this.getDependency("material",g[i].material);h.push(k)}return h.push(b.loadGeometries(g)),Promise.all(h).then(function(c){let h=c.slice(0,c.length-1),i=c[c.length-1],j=[];for(let k=0,l=i.length;k<l;k++){let m=i[k],n=g[k],o,p=h[k];if(n.mode===F.TRIANGLES||n.mode===F.TRIANGLE_STRIP||n.mode===F.TRIANGLE_FAN|| void 0===n.mode)!0!==(o=!0===f.isSkinnedMesh?new d.TUv(m,p):new d.Kj0(m,p)).isSkinnedMesh||o.geometry.attributes.skinWeight.normalized||o.normalizeSkinWeights(),n.mode===F.TRIANGLE_STRIP?o.geometry=Y(o.geometry,d.UlW):n.mode===F.TRIANGLE_FAN&&(o.geometry=Y(o.geometry,d.z$h));else if(n.mode===F.LINES)o=new d.ejS(m,p);else if(n.mode===F.LINE_STRIP)o=new d.x12(m,p);else if(n.mode===F.LINE_LOOP)o=new d.blk(m,p);else if(n.mode===F.POINTS)o=new d.woe(m,p);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+n.mode);Object.keys(o.geometry.morphAttributes).length>0&&R(o,f),o.name=b.createUniqueName(f.name||"mesh_"+a),Q(o,f),n.extensions&&P(e,o,n),b.assignFinalMaterial(o),j.push(o)}for(let q=0,r=j.length;q<r;q++)b.associations.set(j[q],{meshes:a,primitives:q});if(1===j.length)return j[0];let s=new d.ZAu;b.associations.set(s,{meshes:a});for(let t=0,u=j.length;t<u;t++)s.add(j[t]);return s})}loadCamera(a){let b,c=this.json.cameras[a],e=c[c.type];if(!e){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===c.type?b=new d.cPb(d.M8C.radToDeg(e.yfov),e.aspectRatio||1,e.znear||1,e.zfar||2e6):"orthographic"===c.type&&(b=new d.iKG(-e.xmag,e.xmag,e.ymag,-e.ymag,e.znear,e.zfar)),c.name&&(b.name=this.createUniqueName(c.name)),Q(b,c),Promise.resolve(b)}loadSkin(a){let b=this.json.skins[a],c={joints:b.joints};return void 0===b.inverseBindMatrices?Promise.resolve(c):this.getDependency("accessor",b.inverseBindMatrices).then(function(a){return c.inverseBindMatrices=a,c})}loadAnimation(a){let b=this.json,c=b.animations[a],e=[],f=[],g=[],h=[],i=[];for(let j=0,k=c.channels.length;j<k;j++){let l=c.channels[j],m=c.samplers[l.sampler],n=l.target,o=void 0!==n.node?n.node:n.id,p=void 0!==c.parameters?c.parameters[m.input]:m.input,q=void 0!==c.parameters?c.parameters[m.output]:m.output;e.push(this.getDependency("node",o)),f.push(this.getDependency("accessor",p)),g.push(this.getDependency("accessor",q)),h.push(m),i.push(n)}return Promise.all([Promise.all(e),Promise.all(f),Promise.all(g),Promise.all(h),Promise.all(i)]).then(function(b){let e=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=[];for(let k=0,l=e.length;k<l;k++){let m=e[k],n=f[k],o=g[k],p=h[k],q=i[k];if(void 0===m)continue;m.updateMatrix();let r;switch(L[q.path]){case L.weights:r=d.dUE;break;case L.rotation:r=d.iLg;break;case L.position:case L.scale:default:r=d.yC1}let s=m.name?m.name:m.uuid,t=void 0!==p.interpolation?M[p.interpolation]:d.NMF,u=[];L[q.path]===L.weights?m.traverse(function(a){a.morphTargetInfluences&&u.push(a.name?a.name:a.uuid)}):u.push(s);let v=o.array;if(o.normalized){let w=U(v.constructor),x=new Float32Array(v.length);for(let y=0,z=v.length;y<z;y++)x[y]=v[y]*w;v=x}for(let A=0,B=u.length;A<B;A++){let D=new r(u[A]+"."+L[q.path],n.array,v,t);"CUBICSPLINE"===p.interpolation&&(D.createInterpolant=function(a){let b=this instanceof d.iLg?E:C;return new b(this.times,this.values,this.getValueSize()/3,a)},D.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),j.push(D)}}let F=c.name?c.name:"animation_"+a;return new d.m7l(F,void 0,j)})}createNodeMesh(a){let b=this.json,c=this,d=b.nodes[a];return void 0===d.mesh?null:c.getDependency("mesh",d.mesh).then(function(a){let b=c._getNodeRef(c.meshCache,d.mesh,a);return void 0!==d.weights&&b.traverse(function(a){if(a.isMesh)for(let b=0,c=d.weights.length;b<c;b++)a.morphTargetInfluences[b]=d.weights[b]}),b})}loadNode(a){let b=this.json,c=this.extensions,e=this,f=b.nodes[a],g=f.name?e.createUniqueName(f.name):"";return(function(){let b=[],c=e._invokeOne(function(b){return b.createNodeMesh&&b.createNodeMesh(a)});return c&&b.push(c),void 0!==f.camera&&b.push(e.getDependency("camera",f.camera).then(function(a){return e._getNodeRef(e.cameraCache,f.camera,a)})),e._invokeAll(function(b){return b.createNodeAttachment&&b.createNodeAttachment(a)}).forEach(function(a){b.push(a)}),Promise.all(b)})().then(function(b){let h;if((h=!0===f.isBone?new d.N$j:b.length>1?new d.ZAu:1===b.length?b[0]:new d.Tme)!==b[0])for(let i=0,j=b.length;i<j;i++)h.add(b[i]);if(f.name&&(h.userData.name=f.name,h.name=g),Q(h,f),f.extensions&&P(c,h,f),void 0!==f.matrix){let k=new d.yGw;k.fromArray(f.matrix),h.applyMatrix4(k)}else void 0!==f.translation&&h.position.fromArray(f.translation),void 0!==f.rotation&&h.quaternion.fromArray(f.rotation),void 0!==f.scale&&h.scale.fromArray(f.scale);return e.associations.has(h)||e.associations.set(h,{}),e.associations.get(h).nodes=a,h})}loadScene(a){let b=this.json,c=this.extensions,e=this.json.scenes[a],f=this,g=new d.ZAu;e.name&&(g.name=f.createUniqueName(e.name)),Q(g,e),e.extensions&&P(c,g,e);let h=e.nodes||[],i=[];for(let j=0,k=h.length;j<k;j++)i.push(W(h[j],g,b,f));return Promise.all(i).then(function(){return f.associations=(a=>{let b=new Map;for(let[c,e]of f.associations)(c instanceof d.F5T||c instanceof d.xEZ)&&b.set(c,e);return a.traverse(a=>{let c=f.associations.get(a);null!=c&&b.set(a,c)}),b})(g),g})}}function W(a,b,c,e){let f=c.nodes[a];return e.getDependency("node",a).then(function(a){if(void 0===f.skin)return a;let b;return e.getDependency("skin",f.skin).then(function(a){b=a;let c=[];for(let d=0,f=b.joints.length;d<f;d++)c.push(e.getDependency("node",b.joints[d]));return Promise.all(c)}).then(function(c){return a.traverse(function(a){if(!a.isMesh)return;let e=[],f=[];for(let g=0,h=c.length;g<h;g++){let i=c[g];if(i){e.push(i);let j=new d.yGw;void 0!==b.inverseBindMatrices&&j.fromArray(b.inverseBindMatrices.array,16*g),f.push(j)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',b.joints[g])}a.bind(new d.OdW(e,f),a.matrixWorld)}),a})}).then(function(a){b.add(a);let d=[];if(f.children){let g=f.children;for(let h=0,i=g.length;h<i;h++){let j=g[h];d.push(W(j,a,c,e))}}return Promise.all(d)})}function X(a,b,c){let e=b.attributes,f=[];function g(b,d){return c.getDependency("accessor",b).then(function(b){a.setAttribute(d,b)})}for(let h in e){let i=K[h]||h.toLowerCase();i in a.attributes||f.push(g(e[h],i))}if(void 0!==b.indices&&!a.index){let j=c.getDependency("accessor",b.indices).then(function(b){a.setIndex(b)});f.push(j)}return Q(a,b),!function(a,b,c){let e=b.attributes,f=new d.ZzF;if(void 0===e.POSITION)return;{let g=c.json.accessors[e.POSITION],h=g.min,i=g.max;if(void 0!==h&& void 0!==i){if(f.set(new d.Pa4(h[0],h[1],h[2]),new d.Pa4(i[0],i[1],i[2])),g.normalized){let j=U(G[g.componentType]);f.min.multiplyScalar(j),f.max.multiplyScalar(j)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let k=b.targets;if(void 0!==k){let l=new d.Pa4,m=new d.Pa4;for(let n=0,o=k.length;n<o;n++){let p=k[n];if(void 0!==p.POSITION){let q=c.json.accessors[p.POSITION],r=q.min,s=q.max;if(void 0!==r&& void 0!==s){if(m.setX(Math.max(Math.abs(r[0]),Math.abs(s[0]))),m.setY(Math.max(Math.abs(r[1]),Math.abs(s[1]))),m.setZ(Math.max(Math.abs(r[2]),Math.abs(s[2]))),q.normalized){let t=U(G[q.componentType]);m.multiplyScalar(t)}l.max(m)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}f.expandByVector(l)}a.boundingBox=f;let u=new d.aLr;f.getCenter(u.center),u.radius=f.min.distanceTo(f.max)/2,a.boundingSphere=u}(a,b,c),Promise.all(f).then(function(){return void 0!==b.targets?function(a,b,c){let d=!1,e=!1,f=!1;for(let g=0,h=b.length;g<h;g++){let i=b[g];if(void 0!==i.POSITION&&(d=!0),void 0!==i.NORMAL&&(e=!0),void 0!==i.COLOR_0&&(f=!0),d&&e&&f)break}if(!d&&!e&&!f)return Promise.resolve(a);let j=[],k=[],l=[];for(let m=0,n=b.length;m<n;m++){let o=b[m];if(d){let p=void 0!==o.POSITION?c.getDependency("accessor",o.POSITION):a.attributes.position;j.push(p)}if(e){let q=void 0!==o.NORMAL?c.getDependency("accessor",o.NORMAL):a.attributes.normal;k.push(q)}if(f){let r=void 0!==o.COLOR_0?c.getDependency("accessor",o.COLOR_0):a.attributes.color;l.push(r)}}return Promise.all([Promise.all(j),Promise.all(k),Promise.all(l)]).then(function(b){let c=b[0],g=b[1],h=b[2];return d&&(a.morphAttributes.position=c),e&&(a.morphAttributes.normal=g),f&&(a.morphAttributes.color=h),a.morphTargetsRelative=!0,a})}(a,b.targets,c):a})}function Y(a,b){let c=a.getIndex();if(null===c){let e=[],f=a.getAttribute("position");if(void 0===f)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),a;for(let g=0;g<f.count;g++)e.push(g);a.setIndex(e),c=a.getIndex()}let h=c.count-2,i=[];if(b===d.z$h)for(let j=1;j<=h;j++)i.push(c.getX(0)),i.push(c.getX(j)),i.push(c.getX(j+1));else for(let k=0;k<h;k++)k%2==0?(i.push(c.getX(k)),i.push(c.getX(k+1)),i.push(c.getX(k+2))):(i.push(c.getX(k+2)),i.push(c.getX(k+1)),i.push(c.getX(k)));i.length/3!==h&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let l=a.clone();return l.setIndex(i),l}},2666:function(a,b,c){"use strict";c.d(b,{x:function(){return e}});var d=c(9477);class e extends d.yxD{constructor(a){super(a),this.type=d.cLu}parse(a){let b=function(a,b){switch(a){case 1:console.error("THREE.RGBELoader Read Error: "+(b||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(b||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(b||""));break;default:console.error("THREE.RGBELoader: Error: "+(b||""))}return -1},c=function(a,b,c){b=b||1024;let d=a.pos,e=-1,f=0,g="",h=String.fromCharCode.apply(null,new Uint16Array(a.subarray(d,d+128)));for(;0>(e=h.indexOf("\n"))&&f<b&&d<a.byteLength;)g+=h,f+=h.length,d+=128,h+=String.fromCharCode.apply(null,new Uint16Array(a.subarray(d,d+128)));return -1<e&&(!1!==c&&(a.pos+=f+e+1),g+h.slice(0,e))},e=new Uint8Array(a);e.pos=0;let f=function(a){let d=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,e=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,f=/^\s*FORMAT=(\S+)\s*$/,g=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,h={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0},i,j;if(a.pos>=a.byteLength||!(i=c(a)))return b(1,"no header found");if(!(j=i.match(/^#\?(\S+)/)))return b(3,"bad initial token");for(h.valid|=1,h.programtype=j[1],h.string+=i+"\n";!1!==(i=c(a));){if(h.string+=i+"\n","#"===i.charAt(0)){h.comments+=i+"\n";continue}if((j=i.match(d))&&(h.gamma=parseFloat(j[1])),(j=i.match(e))&&(h.exposure=parseFloat(j[1])),(j=i.match(f))&&(h.valid|=2,h.format=j[1]),(j=i.match(g))&&(h.valid|=4,h.height=parseInt(j[1],10),h.width=parseInt(j[2],10)),2&h.valid&&4&h.valid)break}return 2&h.valid?4&h.valid?h:b(3,"missing image size specifier"):b(3,"missing format specifier")}(e);if(-1!==f){let g=f.width,h=f.height,i=function(a,c,d){let e=c;if(e<8||e>32767||2!==a[0]||2!==a[1]||128&a[2])return new Uint8Array(a);if(e!==(a[2]<<8|a[3]))return b(3,"wrong scanline width");let f=new Uint8Array(4*c*d);if(!f.length)return b(4,"unable to allocate buffer space");let g=0,h=0,i=4*e,j=new Uint8Array(4),k=new Uint8Array(i),l=d;for(;l>0&&h<a.byteLength;){if(h+4>a.byteLength)return b(1);if(j[0]=a[h++],j[1]=a[h++],j[2]=a[h++],j[3]=a[h++],2!=j[0]||2!=j[1]||(j[2]<<8|j[3])!=e)return b(3,"bad rgbe scanline format");let m=0,n;for(;m<i&&h<a.byteLength;){n=a[h++];let o=n>128;if(o&&(n-=128),0===n||m+n>i)return b(3,"bad scanline data");if(o){let p=a[h++];for(let q=0;q<n;q++)k[m++]=p}else k.set(a.subarray(h,h+n),m),m+=n,h+=n}let r=e;for(let s=0;s<r;s++){let t=0;f[g]=k[s+t],t+=e,f[g+1]=k[s+t],t+=e,f[g+2]=k[s+t],t+=e,f[g+3]=k[s+t],g+=4}l--}return f}(e.subarray(e.pos),g,h);if(-1!==i){let j,k,l;switch(this.type){case d.VzW:l=i.length/4;let m=new Float32Array(4*l);for(let n=0;n<l;n++)!function(a,b,c,d){let e=a[b+3],f=Math.pow(2,e-128)/255;c[d+0]=a[b+0]*f,c[d+1]=a[b+1]*f,c[d+2]=a[b+2]*f,c[d+3]=1}(i,4*n,m,4*n);j=m,k=d.VzW;break;case d.cLu:l=i.length/4;let o=new Uint16Array(4*l);for(let p=0;p<l;p++)!function(a,b,c,e){let f=a[b+3],g=Math.pow(2,f-128)/255;c[e+0]=d.A5E.toHalfFloat(Math.min(a[b+0]*g,65504)),c[e+1]=d.A5E.toHalfFloat(Math.min(a[b+1]*g,65504)),c[e+2]=d.A5E.toHalfFloat(Math.min(a[b+2]*g,65504)),c[e+3]=d.A5E.toHalfFloat(1)}(i,4*p,o,4*p);j=o,k=d.cLu;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:g,height:h,data:j,header:f.string,gamma:f.gamma,exposure:f.exposure,type:k}}}return null}setDataType(a){return this.type=a,this}load(a,b,c,e){return super.load(a,function(a,c){switch(a.type){case d.VzW:case d.cLu:a.encoding=d.rnI,a.minFilter=d.wem,a.magFilter=d.wem,a.generateMipmaps=!1,a.flipY=!0}b&&b(a,c)},c,e)}}}}])